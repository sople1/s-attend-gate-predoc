# BLE 기반 출석 체크 시스템

## 🎯 프로젝트 개요

### 목적
- **태그리스 출석 체크 시스템** 구축
- 사용자 편의성 향상 (자동 감지)
- 정확한 출입 관리 및 기록

### 핵심 요구사항
- BLE 비콘을 활용한 자동 감지
- GPS 위치 검증으로 보안 강화
- 단일 게이트에서 입/출장 구분
- 실시간 출석 처리 및 알림

---

## 🏗️ 시스템 아키텍처

### 전체 구성
```
[비콘 단말] ←→ [사용자 앱] ←→ [출석 서버]
   (라즈베리파이)     (모바일)      (클라우드/온프레미스)
```

### 주요 컴포넌트
1. **비콘 단말**: 행사장 게이트에 고정 설치
2. **출석 앱**: 사용자 스마트폰에 설치
3. **보물찾기 앱**: 별도 이벤트용 앱 (실험적)
4. **출석 서버**: 출석 데이터 처리 및 관리

---

## 📱 앱 기능 설계

### 출석 체크 앱 (메인)
```
핵심 기능:
- BLE 비콘 자동 감지
- GPS 위치 확인
- 서버 통신 (출석 데이터 전송)
- 출석 결과 알림 표시
- 사용자 출석 현황 조회
```

### 보물찾기 앱 (이벤트용)
```
부가 기능:
- 소형 비콘 감지
- 게임 미션 진행
- 경품 관리
- 앱 사용 유도 역할
```

---

## 🚪 단일 게이트 출입 처리

### 입/출장 판별 로직

#### 1순위: 시간 기반 판별
- 첫 감지 → **입장**
- 5분간 신호 없음 → **퇴장**

#### 2순위: RSSI 패턴 분석
- 신호 강도 증가 → 접근 (**입장**)
- 신호 강도 감소 → 멀어짐 (**퇴장**)

#### 3순위: GPS 보조 검증
- 위치 변화로 방향 판단

### 예외 상황 처리
- **잠깐 외출**: 30분 이내 재입장 시 계속 참석 처리
- **중복 감지**: 단시간 내 재감지 무시
- **신호 간섭**: GPS 및 WiFi로 2차 검증

---

## 🔄 데이터 플로우

### 출석 처리 시퀀스
```
1. [앱] 게이트 비콘 감지
2. [앱] GPS 위치 확인  
3. [앱] → [서버] 출석 요청 전송
4. [서버] 중복 체크 및 출석 처리
5. [서버] → [앱] 처리 결과 응답
6. [앱] 사용자에게 알림 표시
```

### 통신 데이터 구조

#### 출석 요청
```json
{
  "userId": "user123",
  "timestamp": 1234567890,
  "location": {"lat": 37.123, "lng": 127.456},
  "beaconId": "gate_beacon_001"
}
```

#### 서버 응답
```json
{
  "status": "success|duplicate|error",
  "message": "출석 완료|이미 출석|오류 발생",
  "attendanceTime": "09:30:15"
}
```

---

## ⚙️ 기술 스택

### 하드웨어
- **게이트 비콘**: 라즈베리파이 + BLE 모듈
- **보물찾기 비콘**: ESP32/Arduino + BLE

### 소프트웨어
- **모바일 앱**: React Native 또는 Flutter
- **백엔드**: Node.js, Python Flask/FastAPI
- **데이터베이스**: MongoDB, PostgreSQL
- **클라우드**: AWS/Azure/GCP (선택사항)

---

## 🔒 보안 및 검증

### 다층 검증 시스템
```
1차: BLE 비콘 감지 (근거리 확인)
2차: GPS 좌표 검증 (정확한 위치)  
3차: 지오펜스 경계 확인 (범위 검증)
4차: 시간 패턴 분석 (비정상 행동 감지)
```

### 부정 방지
- **대리 출석 방지**: GPS 검증
- **중복 출석 방지**: 서버 로직
- **위치 조작 방지**: 다중 검증

---

## 📊 예상 성능

### 감지 성공률
| 앱 상태 | 성공률 | 비고 |
|---------|--------|------|
| 실행 상태 | 95-98% | 최적 조건 |
| 백그라운드 | 80-85% | OS 제약 존재 |
| 종료 상태 | - | QR코드 백업 필요 |

### 사용자 경험
- **자동 감지**: 태그리스 편의성
- **즉시 알림**: 출석 확인 피드백
- **게임화**: 보물찾기로 참여 유도

---

## 🚀 구현 단계

### Phase 1: 기본 시스템
1. 비콘 하드웨어 설치
2. 출석 앱 개발
3. 서버 구축
4. 기본 출입 관리

### Phase 2: 고도화
1. 보물찾기 이벤트 추가
2. 분석 대시보드 구축
3. 머신러닝 패턴 분석
4. 성능 최적화

### Phase 3: 확장
1. 다중 행사장 지원
2. 실시간 모니터링
3. 외부 시스템 연동
4. API 제공

---

## 💡 핵심 인사이트

### 기술적 제약사항
- **비콘**: 단방향 통신만 가능 (개별 타겟팅 불가)
- **앱 상태**: 종료 시 감지 불가능
- **GPS**: 실내에서 정확도 제한

### 해결책
- **하이브리드 접근**: BLE + GPS + 시간 기반 판별
- **게임화**: 보물찾기로 앱 사용 유도  
- **백업 시스템**: QR코드 수동 체크인

---

## 🎯 결론

이 시스템으로 기존 수동 출석 체크 방식 대비 **편의성과 정확성을 크게 향상**시킬 수 있을 것으로 예상됩니다.

### 핵심 성공 요인
1. **사용자 교육** 및 앱 사용 유도
2. **다중 검증** 시스템으로 정확도 확보
3. **적절한 인센티브** 설계 (보물찾기 등)
4. **예외 상황** 대응 체계 구축